(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{151:function(a,t,s){"use strict";s.r(t);var n=s(0),e=Object(n.a)({},(function(){var a=this.$createElement;this._self._c;return this._m(0)}),[function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"微信小程序canvas生成图片转base64"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微信小程序canvas生成图片转base64","aria-hidden":"true"}},[a._v("#")]),a._v(" 微信小程序canvas生成图片转base64")]),s("div",{staticClass:"language-需要用到的接口和包 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("*** wx.canvasPutImageData(OBJECT, this)\n*** UPNG.js\n*** wx.createCanvasContext(canvasId, this)\n## canvas输出信息的获取\nwx.canvasPutImageData(OBJECT, this)这个方法需要在建议在draw回调函数中调用\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v(" drawBase64(ctx) {  // ctx 是指创建的canvas对象\n    const { width, height } = this.data; // width 和 height 指需要生成的图片的尺寸\n    const _this = this;\n    ctx.draw(true, wx.canvasGetImageData({ // true 保留上次绘制的图形\n      canvasId: 'myCanvas',\n      x: 0,  // x y 指距离canvas原点的位置\n      y: 0,\n      width,\n      height,\n      success(res) {\n        const pngData = upng.encode([res.data.buffer], res.width, res.height); \n        //这里需要引入一个第三方的库，来实现将canvas的信息转换成base64\n        const bs64 = wx.arrayBufferToBase64(pngData);\n      },\n    }));\n  },\n")])])]),s("h2",{attrs:{id:"upng-js库的引用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#upng-js库的引用","aria-hidden":"true"}},[a._v("#")]),a._v(" UPNG.JS库的引用")]),s("p",[a._v("下载")]),s("div",{staticClass:"language-npm install upng-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("然后将node_modules 中uping-js 和 pako两个文件移动到微信小程序的utils目录中，确保 UPNG.JS和PAKO.JS两个文件在同一个文件夹下\n然后在需要用到upng的地方使用require的方式引入\n``` const upng = require('../../utils/upng-js/UPNG.js');\n\n## cnavas生成图片\n``` 微信小程序提供了wx.canvasToTempFilePath(OBJECT, this)这个方法用来生成图。次方法也在dra回调函数中调用就行。需要注意的是，canvas默认背景色是黑色，所以需要是使用其他颜色的底色，需要使用 ctx.setFillStyle('#ffffff') 和 ctx.fillRect(0, 0, width, height); 将背景色做转换。")])])])])}],!1,null,null,null);t.default=e.exports}}]);