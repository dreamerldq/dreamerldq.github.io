<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>用原生JS实现todolist | 素妆技术博客</title>
    <meta name="description" content="技术博客，内容多以工作学习中的实践经验为主，主要侧重于前端方向">
    
    
    <link rel="preload" href="/assets/css/styles.1700d348.css" as="style"><link rel="preload" href="/assets/js/app.1700d348.js" as="script"><link rel="preload" href="/assets/js/18.3b928a01.js" as="script"><link rel="prefetch" href="/assets/js/1.a5f23d81.js"><link rel="prefetch" href="/assets/js/10.ea35f83b.js"><link rel="prefetch" href="/assets/js/11.43ee7260.js"><link rel="prefetch" href="/assets/js/12.e4255072.js"><link rel="prefetch" href="/assets/js/13.1790464a.js"><link rel="prefetch" href="/assets/js/14.8f998397.js"><link rel="prefetch" href="/assets/js/15.c504318f.js"><link rel="prefetch" href="/assets/js/16.07eedc5e.js"><link rel="prefetch" href="/assets/js/17.61192b7e.js"><link rel="prefetch" href="/assets/js/19.9f962ae5.js"><link rel="prefetch" href="/assets/js/2.58bf56ce.js"><link rel="prefetch" href="/assets/js/20.cf8c0abf.js"><link rel="prefetch" href="/assets/js/21.d3213113.js"><link rel="prefetch" href="/assets/js/22.dc22b7ce.js"><link rel="prefetch" href="/assets/js/23.98aee9d6.js"><link rel="prefetch" href="/assets/js/24.3c7c5e9a.js"><link rel="prefetch" href="/assets/js/25.72b30a79.js"><link rel="prefetch" href="/assets/js/3.98a464b0.js"><link rel="prefetch" href="/assets/js/4.6e491b29.js"><link rel="prefetch" href="/assets/js/5.3f38bc31.js"><link rel="prefetch" href="/assets/js/6.6aff7983.js"><link rel="prefetch" href="/assets/js/7.4d654c70.js"><link rel="prefetch" href="/assets/js/8.22705928.js"><link rel="prefetch" href="/assets/js/9.44fd09d3.js">
    <link rel="stylesheet" href="/assets/css/styles.1700d348.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      素妆技术博客
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/dreamerldq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/dreamerldq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><ul class="sidebar-links"><li><a href="/" class="sidebar-link">Home</a></li><li><a href="/webpack.html" class="sidebar-link">webpack-react-ts配置</a></li><li><a href="/githubpage.html" class="sidebar-link">github page 部署</a></li><li><a href="/iconfont.html" class="sidebar-link">文字图标的使用</a></li><li><a href="/miniPrograme.html" class="sidebar-link">小程序开发总结</a></li><li><a href="/redux.html" class="sidebar-link">Redux源码解析</a></li><li><a href="/wixinqr.html" class="sidebar-link">微信小程序二维码生成</a></li><li><a href="/webpack-vue.html" class="sidebar-link">webpack-vue多页面配置</a></li><li><a href="/egg.html" class="sidebar-link">egg框架</a></li><li><a href="/eslint.html" class="sidebar-link">微信小程序eslint配置</a></li><li><a href="/H5_Video.html" class="sidebar-link">H5录制视频</a></li><li><a href="/minicanvas.html" class="sidebar-link">微信小程序canvas生成图片转base64</a></li><li><a href="/webaudio.html" class="sidebar-link">web audio api 绘制频率图</a></li><li><a href="/globalNotice.html" class="sidebar-link">React全局通知组件的实现</a></li><li><a href="/cssinjs.html" class="sidebar-link">css in js在React中的使用</a></li><li><a href="/React.cloneElement.html" class="sidebar-link">React.cloneElement实现单选框组</a></li><li><a href="/mobile.html" class="sidebar-link">移动端适配（H5 and RN）</a></li><li><a href="/Nginx.html" class="sidebar-link">Nginx配置</a></li><li><a href="/browserCache.html" class="sidebar-link">浏览器缓存机制</a></li></ul></div><div class="page"><div class="content"><h1 id="用原生js实现todolist"><a href="#用原生js实现todolist" aria-hidden="true" class="header-anchor">#</a> 用原生JS实现todolist</h1><p>todolist具备以下几个功能点：</p><ul><li>拥有一个输入框，可以输入待办事项</li><li>添加按钮，将输入框中的待办事项添加到待办数组中</li><li>列表展示待办项目。</li><li>每一条待办项目都可以完成或者取消（ui效果是完成，checkbox为true，文案添加中划线， 取消，checkbox为false，文案正常显示）</li><li>每一条待办项目都有编辑和删除两个按钮，点击删除，从待办事项列表中删除此条待办项目，点击编辑，可直接编辑此条待办项目，</li><li>添加搜索框，搜索到匹配的待办项目后，在列表中展示。</li></ul><div class="language- extra-class"><pre class="language-text"><code>class Page {

  constructor() {
    this.todolist = []; //初始化待办项目列表
    this.searchlist = [];//初始化搜索列表
    this.bottom = document.getElementsByClassName('bottom')[0]; // 获取待办事项列表ul
    this.searchInput = document.getElementsByClassName('search-input')[0]; //获取搜索框
  }
  // 初始化
  init() {
    const addBtn = document.getElementsByClassName('add')[0]; //获取到添加按钮
    const searchBtn = document.getElementsByClassName('search-btn')[0]; //获取到搜索按钮
    addBtn.addEventListener('click', this.handleAddClick.bind(this));// 给添加按钮添加click事件
    this.bottom.addEventListener('click', this.handleItemClick.bind(this));//给待办事项列表添加事件委托
    searchBtn.addEventListener('click', this.handleSearchClick.bind(this));//给搜索按钮添加click事件
  }
  // 处理新增事项
  handleAddClick() {
    this.searchInput.value = '';
    let input = document.getElementsByClassName('input')[0]; //获取输入框的值
    let inputVal = input.value;
    if (!inputVal) {
      alert('输入值为空，请重新输入');
      return;
    }
    this.todolist.push({ inputVal, checked: false }); //如果输入框的值非空，则添加数据对象至待办事项列表中
    this.handleHtml(this.todolist); // 调用渲染html的方法，将待办事项列表渲染在界面中
    input.value = '';
  }
  // 为listItem添加监听事件
  handleItemClick(e) {
    const index = e.target.parentNode.getAttribute('data-key'); //获取到事件委托对象的data-key值，作为被点击的待办事项的index值
    switch(e.target.className) { // 根据被点击的元素的classname值，做出相应的处理
      case 'del': 
        this.handleDelClick(index);
        break;
      case 'edit':
        this.handleEditClick(e.target, index);
        break;
      case 'checkbox':
        this.handleDoneClick(e.target, index);
      case 'default':
        break;
    }
  }
  // 处理多选框点击事件 done
  handleDoneClick(el, index) {
    if (el.checked) {
      el.nextElementSibling.classList.add(&quot;line-through&quot;);
      this.todolist.splice(index, 1, {...this.todolist[index], checked: true});
    } else {
      el.nextElementSibling.classList.remove(&quot;line-through&quot;);
      this.todolist.splice(index, 1, {...this.todolist[index], checked: false});
    }
  }
  // 处理删除事件
  handleDelClick(index) { //将被点击的元素删除，并重新渲染界面
    this.todolist.splice(index, 1);
    this.handleHtml(this.todolist);
  }
  // 处理编辑事件
  handleEditClick(el, index) {
    // 虚拟一个input框在span上面
    let input = document.createElement('input'); //创建一个新的input节点
    input.className = 'text-input'; // 给新创建的input节点添加classname
    let textElement = el.previousElementSibling.previousElementSibling; //将待办事项的内容作为输入框的默认内容， 、、// 、、//previousElementSibling可以获取到同层级下，当前结点的上一个结点
    input.value = textElement.innerHTML;
    textElement.classList.add('display');
    el.parentNode.insertBefore(input, el); //将当前的输入框插入到编辑元素的前边
    input.focus(); //自动获取焦点
    input.addEventListener('blur', () =&gt; { //设置当失去焦点后的回调
      textElement.innerHTML = input.value; // 将编辑的值改成输入框中的值
      this.todolist.splice(index, 1, {...this.todolist[index], inputVal: input.value}); 
      textElement.classList.remove('display');
      el.parentNode.removeChild(input); // 删除掉输入框
    });
    return;
  }
  // 处理搜索事件
  handleSearchClick() {
    let inputVal = this.searchInput.value;
    if (this.todolist.length === 0) {
      alert('当前无事项，请添加事项……');
      return;
    }
    if (!inputVal) {
      alert('匹配值不能为空，请输入具体内容……');
      return;
    }
    const reg = new RegExp(inputVal);
    this.searchlist = this.todolist.filter( ({inputVal})=&gt;{
      return reg.test(inputVal);
    }); //筛选数组，获取到可以匹配指定搜索内容的待办事项
    this.handleHtml(this.searchlist);
  }
  // 处理html;
  handleHtml(list) {
    let html = '';
    list.forEach(({inputVal, checked}, index) =&gt; {
      html += `
      &lt;li data-key=&quot;${index}&quot;&gt;
        &lt;input class=&quot;checkbox&quot; type=&quot;checkbox&quot; name=&quot;checkbox&quot; ${checked ? 'checked' : ''}&gt;
        &lt;span class=&quot;text ${checked ? 'line-through' : ''}&quot;&gt;${inputVal}&lt;/span&gt;
        &lt;a class=&quot;del&quot;&gt;删除&lt;/a&gt;
        &lt;a class=&quot;edit&quot;&gt;编辑&lt;/a&gt;
      &lt;/li&gt;
    `
    });
    this.bottom.innerHTML = html;
  }
}
var page = new Page()
page.init();
</code></pre></div><h3 id="html"><a href="#html" aria-hidden="true" class="header-anchor">#</a> HTML</h3><div class="language- extra-class"><pre class="language-text"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;
  &lt;title&gt;todoList-youran&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./todoList.css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;todoList&quot;&gt;
    &lt;div class=&quot;top&quot;&gt;
      &lt;input class=&quot;input&quot; type=&quot;text&quot; value=&quot;&quot; placeholder=&quot;请输入……&quot;/&gt;
      &lt;a class=&quot;add&quot; href=&quot;javascript:;&quot;&gt;点击添加新事项&lt;/a&gt;
    &lt;/div&gt;
    &lt;ul class=&quot;bottom&quot;&gt;&lt;/ul&gt;
    &lt;div class=&quot;search&quot;&gt;
      &lt;input class=&quot;search-input&quot; type=&quot;text&quot; value=&quot;&quot; placeholder=&quot;请输入关键字……&quot;/&gt;
      &lt;a class=&quot;search-btn&quot; href=&quot;javascript:;&quot;&gt;过滤&lt;/a&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;script src=&quot;./todoList.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><h3 id="css"><a href="#css" aria-hidden="true" class="header-anchor">#</a> CSS</h3><div class="language- extra-class"><pre class="language-text"><code>* {
  margin: 0;
  padding: 0;
}
li {
  list-style: none;
}
a {
  color: #000;
  text-decoration: none;
}
a:hover {
  color: #fff;
}
input {
  background: none;  
	outline: none;  
	border: 0px;
}
html, body {
  background: #f7f7f7;
  font-size: 14px;
  font-style: normal;
}
.todoList {
  width: 500px;
  height: 440px;
  margin: 20px auto;
  background: #ddd;
  /* border: 1px solid salmon; */
  border-radius: 3px;
}
.top,
.search {
  height: 50px;
  line-height: 50px;
  /* background: #ff5200; */
  background: salmon;
  border-radius: 3px;
  padding: 0 10px;
}
.search {
  margin-top: -3px;
}
.top .input,
.search-input {
  width: 300px;
  height: 30px;
  background: #fff;
  border-radius: 3px;
  padding-left: 10px;
}
.add,
.search-btn {
  float: right;
  width: 120px;
  padding: 0 10px;
}
.bottom {
  height: 380px;
  /* overflow: hidden; */
  overflow: scroll;
  padding-top: 10px;
  /* padding: 10px 0; */
}
.bottom li {
  padding: 10px;
  margin-bottom: 10px;
  line-height: 24px;
  border-radius: 3px;
  color: #fff;
  background: salmon;
}
.bottom .text-input {
  font-size: 16px;
  width: 380px;
  color: #fff;
  background: salmon;
}
.bottom li:nth-child(2n-1),
.bottom li:nth-child(2n-1) .text-input{
  background: #fff;
  color: salmon;
}
.edit,
.del {
  float: right;
  margin-left: 10px;
  cursor: pointer;
}
.edit:hover,
.del:hover {
  color: #409eff;
}
.display {
  display: none;
}
.line-through {
  text-decoration: line-through;
}

</code></pre></div></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/app.1700d348.js" defer></script><script src="/assets/js/18.3b928a01.js" defer></script>
  </body>
</html>
